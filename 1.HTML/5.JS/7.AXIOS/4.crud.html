<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body>
    <h1>json placeholder typico사이트에 crud 해보기</h1>
    <div>
        <h3>포스트 생성하기</h3>
        <button id="createPost">포스트 생성</button>
    </div>
    <div>
        <h3>포스트 조회하기</h3>
        <button id="post_id_prev">&lt;&lt;</button>
        <input id="post_id" type="number" placeholder="조회아이디 입력" />
        <button id="post_id_next">&gt;&gt;</button>
        <button id="readPost">포스트 조회</button>
    </div>
    <div>
        <h3>포스트 수정하기</h3>
        <button id="updatePost">포스트 수정</button>
    </div>
    <div>
        <h3>포스트 삭제하기</h3>
        <button id="deletePost">포스트 삭제</button>
    </div>
    <div>
        <h3>공통결과를 출력할 곳</h3>
        <div id="result"></div>
    </div>
    <script>
        const baseURL = 'https://jsonplaceholder.typicode.com/posts';

        async function createPost(post) {
            try {
                const response = await axios.post(baseURL, post)
                const data = response.data;

                console.log(data);
                //객체 -> json 문자열
                document.getElementById('result').innerText = JSON.stringify(data)
            } catch (err) {
                alert(err);
            }
        }

        document.getElementById('createPost').addEventListener('click', () => {
            console.log('create 버튼 눌림');
            const myPost = {
                title: 'sesac',
                body: 'seoul',
                userId: 1,
            };

            createPost(myPost);
        });

        let prevClickValid = true;

        async function readPost(postId) {
            try {
                const response = await axios.get(`${baseURL}/${postId}`);
                const data = response.data;

                console.log(data);
                document.getElementById('result').innerText = JSON.stringify(data);
            } catch (err) {
                alert(err);
            }
        }

        document.getElementById('readPost').addEventListener('click', () => {
            console.log('read 버튼 눌림');

            const inputDiv = document.getElementById('post_id');
            const inputValue = inputDiv.value;

            if (inputValue >= 1) {
                readPost(inputValue);
            } else {
                console.log("1이상 입력해주세요.");
            }

        });

        document.getElementById('post_id_prev').addEventListener('click', () => {
            const inputDiv = document.getElementById('post_id');
            let inputValue = Number(inputDiv.value);

            if (inputValue <= 1) {
                prevClickValid = false;
            }
            else {
                prevClickValid = true;
            }

            if (prevClickValid) {
                inputValue -= 1;
                inputDiv.value = inputValue;
            }

        });

        document.getElementById('post_id_next').addEventListener('click', () => {
            const inputDiv = document.getElementById('post_id');
            let inputValue = Number(inputDiv.value);
            inputValue += 1;
            inputDiv.value = inputValue;
        });

        async function updatePost(post) {
            try {
                const response = await axios.put(`${baseURL}/1`, post);

                const data = response.data
                console.log(data);

                document.getElementById('result').innerText = JSON.stringify(data)
            } catch (err) {
                alert(err);
            }
        }

        document.getElementById('updatePost').addEventListener('click', () => {
            console.log('update 버튼 눌림');

            const myUpdatePost = {
                id: 1,
                title: 'sesac',
                body: 'seoul',
                userId: 1,
            }
            updatePost(myUpdatePost);
        });

        async function deletePost(postId) {
            try {
                const response = await axios.delete(`${baseURL}/${postId}`);
                const data = response.data;

                console.log(data);
                document.getElementById('result').innerText = JSON.stringify(data)
            } catch (err) {
                alert(err);
            }
        }

        document.getElementById('deletePost').addEventListener('click', () => {
            console.log('deletePost 버튼 눌림');

            deletePost(1);
        });
    </script>
</body>

</html>